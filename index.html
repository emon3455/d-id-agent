<!DOCTYPE html>
<html>
  <head>
    <title>NY Estate LAW AI AVATAR</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style-agents.css" />
    <link rel="icon" type="image/png" sizes="192x192" href="https://studio.d-id.com/favicon/favicon-192x192.png" />
  </head>

  <body class="container-xl">
    <div class="center">
      <div class="">
        <div id="loadingContainer" class="statusContainer">Loading...</div>

        <div class="flex-2 hide">
          <div id="status">
            <h4>Agent Status</h4>
            Agent ID: <label id="agentId-label"></label><br />
            Chat ID: <label id="chatId-label"></label><br />
            <br />
            <h4>WebRTC Connection Status</h4>
            ICE gathering status: <label id="ice-gathering-status-label"></label><br />
            ICE status: <label id="ice-status-label"></label><br />
            Peer connection status: <label id="peer-status-label"></label><br />
            Signaling status: <label id="signaling-status-label"></label><br />
            Streaming status: <label id="streaming-status-label"></label><br />
            <br />
            <div id="buttons">
              <button id="connect-button" type="button">Connect</button>
            </div>
          </div>
          <div class="chat">
            <h4>Chat History</h4>
            <div id="msgHistory"></div>
          </div>
        </div>
        <div class="" id="mainContent">
          <div class="card">
            <h2 class="chat-header">Chat Window</h2>
            <div class="flex-2">
              <div class="width-100">
                <textarea id="outputText" cols="70" rows="8" placeholder="status"></textarea>
                <br />
                <input type="text" id="inputText" placeholder="Prompt" />
              </div>
              <div id="video-wrapper">
                <div>
                  <video
                    id="video-element"
                    height="270"
                    width="270"
                    src=""
                    autoplay
                    loop
                    muted
                    class="animated"
                  ></video>
                </div>
              </div>
            </div>
          </div>
          <button id="destroy-button" type="button">Back</button>
        </div>
      </div>
    </div>

    <script type="module" src="./agents-client-api.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      const loadingContainer = document.getElementById('loadingContainer');
      const mainContent = document.getElementById('mainContent');

      // Function to check loading status and update content visibility
      function checkLoadingStatus() {
        if (loadingContainer.textContent.trim() === 'Loading...') {
          mainContent.classList.add('hide');
        } else {
          mainContent.classList.remove('hide');
        }
      }

      // Initial check
      checkLoadingStatus();

      // Set up MutationObserver to watch for changes to the loadingContainer
      const observer = new MutationObserver(checkLoadingStatus);
      observer.observe(loadingContainer, { childList: true, subtree: true, characterData: true });
    </script>
  </body>
</html>
